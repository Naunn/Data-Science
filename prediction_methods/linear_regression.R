# LINEAR REGRESSION ====================================================================================================
# In statistics, linear regression is a linear approach for modelling the relationship between a scalar response and one
# or more explanatory variables (also known as dependent and independent variables). The case of one explanatory variable
# is called simple linear regression; for more than one, the process is called multiple linear regression.
# This term is distinct from multivariate linear regression, where multiple correlated dependent variables are predicted,
# rather than a single scalar variable.

# Libraries ============================================================================================================
library(dplyr)
library(tidyr)

# Data =================================================================================================================
data(starwars) # Starwars characters

starwars %>% glimpse()
# Rows: 87
# Columns: 14
# $ name       <chr> "Luke Skywalker", "C-3PO", "R2-D2", "Darth Vader", "Leia Organa", "…
# $ height     <int> 172, 167, 96, 202, 150, 178, 165, 97, 183, 182, 188, 180, 228, 180,…
# $ mass       <dbl> 77.0, 75.0, 32.0, 136.0, 49.0, 120.0, 75.0, 32.0, 84.0, 77.0, 84.0,…
# $ hair_color <chr> "blond", NA, NA, "none", "brown", "brown, grey", "brown", NA, "blac…
# $ skin_color <chr> "fair", "gold", "white, blue", "white", "light", "light", "light", …
# $ eye_color  <chr> "blue", "yellow", "red", "yellow", "brown", "blue", "blue", "red", …
# $ birth_year <dbl> 19.0, 112.0, 33.0, 41.9, 19.0, 52.0, 47.0, NA, 24.0, 57.0, 41.9, 64…
# $ sex        <chr> "male", "none", "none", "male", "female", "male", "female", "none",…
# $ gender     <chr> "masculine", "masculine", "masculine", "masculine", "feminine", "ma…
# $ homeworld  <chr> "Tatooine", "Tatooine", "Naboo", "Tatooine", "Alderaan", "Tatooine"…
# $ species    <chr> "Human", "Droid", "Droid", "Human", "Human", "Human", "Human", "Dro…
# $ films      <list> <"The Empire Strikes Back", "Revenge of the Sith", "Return of the …
# $ vehicles   <list> <"Snowspeeder", "Imperial Speeder Bike">, <>, <>, <>, "Imperial Sp…
# $ starships  <list> <"X-wing", "Imperial shuttle">, <>, <>, "TIE Advanced x1", <>, <>,…

# Simple linear regression =============================================================================================
# Model on nested dataframe
df_models <-
  starwars %>% 
  nest_by(species) 

  # mutate(model = list(lm(weight ~ ., data = data)))
